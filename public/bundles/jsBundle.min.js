!function(){"use strict";function e(e,t){e.state("Home",{url:"/",templateUrl:"views/home.html"}).state("parking",{url:"/parking",templateUrl:"views/parking.html"}).state("postSpot",{url:"/postSpot",templateUrl:"views/PostSpot.html"}),t.otherwise("/")}function t(e,t,o,s){e.$on("$stateChangeStart",function(e,t,n,r,a){var l="Login"===t.name,i="Register"===t.name;if(!l&&!i){var u=s.status;u.isLoggedIn===!1&&(e.preventDefault(),o.go("Login"))}})}angular.module("app",["ui.router"]).config(e),e.$inject=["$stateProvider","$urlRouterProvider"],t.$inject=["$rootScope","$location","$state","UserFactory"]}(),function(){"use strict";function e(e,t){function o(t){e.removeSpot(t)}function s(){a=new google.maps.Geocoder;var t=new google.maps.LatLng(37.775,-122.419),o={zoom:15,center:t,disableDefaultUI:!0,scrollwheel:!0,draggable:!0,scaleControl:!0,panControl:!0,zoomControl:!0,styles:[{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"},{lightness:17}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#000000"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"},{lightness:16}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#000000"},{lightness:21}]},{elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#000000"},{lightness:19}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:17},{weight:1.2}]}]};r.search=function(){e.search(a).then(function(e){r.map.setCenter(e.geometry.location);var t=new google.maps.LatLngBounds(e.geometry.location);r.map.fitBounds(t)})};var s=document.getElementById("map");r.map=new google.maps.Map(s,o),r.image="bootstrap/img/map_marker-512.png";new google.maps.LatLng(37.775,-122.419)}function n(){var e=r.spots.map(function(e){return e.address});angular.forEach(e,function(e){a.geocode({address:e},function(e,t){if(t==google.maps.GeocoderStatus.OK&&e.length>0){new google.maps.Marker({map:r.map,position:e[0].geometry.location,icon:r.image})}else alert("Geocode was not successful for the following reason: "+t)})})}var r=this;r.spots=e.spots,r.deleteSpot=o,r.codeAddress=n,r.status=t.status,r.status.isopen=!1,r.logout=t.logout,google.maps.event.addDomListener(window,"load",s);var a}angular.module("app").controller("HomeController",e),e.$inject=["HomeFactory","UserFactory"]}(),function(){"use strict";function e(e){var t=this;t.user={},t.scrollTo=function(e){window.scrollTo(0,$(e)[0].offsetTop-5)}}angular.module("app").controller("NavCtrl",e),e.$inject=["$state"]}(),function(){"use strict";function e(e,t){function o(){e.upload(s.spot).then(function(){s.spot={},t.go("parking")})}var s=this;s.upload=o}angular.module("app").controller("postSpotCtrl",e),e.$inject=["HomeFactory","$state"]}(),angular.module("app").controller("TestCtrl",["$scope","$modal",function(e,t){e.open=function(o){t.open({animation:e.animationsEnabled,templateUrl:"spotModal.html",controller:"ModalInstanceCtrl",resolve:{spot:function(){return o}}})}}]),angular.module("app").controller("ModalInstanceCtrl",["$scope","$modalInstance","spot",function(e,t,o){e.spot=o,e.ok=function(){t.close()},e.cancel=function(){t.dismiss("cancel")}}]),function(){"use strict";function e(e,t){function o(){var o=n.user;return o.username&&o.email&&o.password&&o.cpassword&&o.password===o.cpassword?void e.signup(o).then(function(){n.user={},t.go("parking")}):!1}function s(){e.login(n.user).then(function(){n.user={},t.go("parking")})}var n=this;n.user={},n.signup=o,n.login=s}angular.module("app").controller("userCtrl",e),e.$inject=["UserFactory","$state"]}(),function(){"use strict";function e(e,t){function o(e){var o=t.defer(),s=document.getElementById("address").value;return e.geocode({address:s},function(e,t){t==google.maps.GeocoderStatus.OK?o.resolve(e[0]):(alert("Geocode was not successful for the following reason: "+t),o.reject())}),o.promise}function s(o){var s=t.defer();return o.deleted=null,e.post("/api/Spot",o,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).success(function(e){o._id=e._id,o.created=e.created,o.user=JSON.parse(atob(localStorage.token.split(".")[1])).username,s.resolve()}).error(function(e){console.error(e)}),s.promise}function n(t){e["delete"]("/api/Spot/"+t._id,{headers:{Authorization:"Bearer "+localStorage.token}}).success(function(){r.spots.splice(r.spots.indexOf(t),1)})}var r={};return r.spots=[],r.upload=s,r.removeSpot=n,r.search=o,e.get("/api/Spot").success(function(e){for(var t=0;t<e.length;t++)r.spots.push(e[t])}),r}angular.module("app").factory("HomeFactory",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e,t){function o(o){console.log("dfsfs");var s=t.defer();return e.post("/api/Users/Signup",o).success(function(e){r(e.token),u.status.isLoggedIn=!0,s.resolve()}),s.promise}function s(o){var s={username:o.username.toLowerCase(),password:o.password},n=t.defer();return e.post("/api/Users/Login",s).success(function(e){r(e.token),u.status.isLoggedIn=!0,n.resolve()}),n.promise}function n(){u.status.isLoggedIn=!1,l()}function r(e){localStorage.setItem("token",e),u.status.username=i()}function a(){return localStorage.token}function l(){localStorage.removeItem("token"),u.status.username=null}function i(){return JSON.parse(atob(a().split(".")[1])).username}var u={};return u.status={},a()?(u.status.isLoggedIn=!0,u.status.username=i()):(u.status.isLoggedIn=!1,u.status.username=null),u.setToken=r,u.getToken=a,u.removeToken=l,u.signup=o,u.login=s,u.logout=n,u}angular.module("app").factory("UserFactory",e),e.$inject=["$http","$q"]}();